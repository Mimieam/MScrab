
<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="test/qunit-1.10.0.css">
  <link rel="stylesheet" href="style.css">
<!-- 
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js"></script> -->

<link href="jquery-ui.css" rel="stylesheet" type="text/css" />
<script src="jquery.min.js"></script>
<script src="jquery-ui.min.js"></script>

<!-- <script src="http://ianli.com/infinitedrag/javascripts/jquery.infinitedrag.js"></script> -->
  <script src="test/qunit-1.10.0.js"></script>
 <script src="server.js"></script>

<script>
  f = function(){
      var parserjs=document.createElement('script');
      parserjs.setAttribute("src", "data:text/plain;charset=utf-8;base64,bW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXsKICAvKgogICAqIEdlbmVyYXRlZCBieSBQRUcuanMgMC43LjAuCiAgICoKICAgKiBodHRwOi8vcGVnanMubWFqZGEuY3ovCiAgICovCiAgCiAgZnVuY3Rpb24gcXVvdGUocykgewogICAgLyoKICAgICAqIEVDTUEtMjYyLCA1dGggZWQuLCA3LjguNDogQWxsIGNoYXJhY3RlcnMgbWF5IGFwcGVhciBsaXRlcmFsbHkgaW4gYQogICAgICogc3RyaW5nIGxpdGVyYWwgZXhjZXB0IGZvciB0aGUgY2xvc2luZyBxdW90ZSBjaGFyYWN0ZXIsIGJhY2tzbGFzaCwKICAgICAqIGNhcnJpYWdlIHJldHVybiwgbGluZSBzZXBhcmF0b3IsIHBhcmFncmFwaCBzZXBhcmF0b3IsIGFuZCBsaW5lIGZlZWQuCiAgICAgKiBBbnkgY2hhcmFjdGVyIG1heSBhcHBlYXIgaW4gdGhlIGZvcm0gb2YgYW4gZXNjYXBlIHNlcXVlbmNlLgogICAgICoKICAgICAqIEZvciBwb3J0YWJpbGl0eSwgd2UgYWxzbyBlc2NhcGUgZXNjYXBlIGFsbCBjb250cm9sIGFuZCBub24tQVNDSUkKICAgICAqIGNoYXJhY3RlcnMuIE5vdGUgdGhhdCAiXDAiIGFuZCAiXHYiIGVzY2FwZSBzZXF1ZW5jZXMgYXJlIG5vdCB1c2VkCiAgICAgKiBiZWNhdXNlIEpTSGludCBkb2VzIG5vdCBsaWtlIHRoZSBmaXJzdCBhbmQgSUUgdGhlIHNlY29uZC4KICAgICAqLwogICAgIHJldHVybiAnIicgKyBzCiAgICAgIC5yZXBsYWNlKC9cXC9nLCAnXFxcXCcpICAvLyBiYWNrc2xhc2gKICAgICAgLnJlcGxhY2UoLyIvZywgJ1xcIicpICAgIC8vIGNsb3NpbmcgcXVvdGUgY2hhcmFjdGVyCiAgICAgIC5yZXBsYWNlKC9ceDA4L2csICdcXGInKSAvLyBiYWNrc3BhY2UKICAgICAgLnJlcGxhY2UoL1x0L2csICdcXHQnKSAgIC8vIGhvcml6b250YWwgdGFiCiAgICAgIC5yZXBsYWNlKC9cbi9nLCAnXFxuJykgICAvLyBsaW5lIGZlZWQKICAgICAgLnJlcGxhY2UoL1xmL2csICdcXGYnKSAgIC8vIGZvcm0gZmVlZAogICAgICAucmVwbGFjZSgvXHIvZywgJ1xccicpICAgLy8gY2FycmlhZ2UgcmV0dXJuCiAgICAgIC5yZXBsYWNlKC9bXHgwMC1ceDA3XHgwQlx4MEUtXHgxRlx4ODAtXHVGRkZGXS9nLCBlc2NhcGUpCiAgICAgICsgJyInOwogIH0KICAKICB2YXIgcmVzdWx0ID0gewogICAgLyoKICAgICAqIFBhcnNlcyB0aGUgaW5wdXQgd2l0aCBhIGdlbmVyYXRlZCBwYXJzZXIuIElmIHRoZSBwYXJzaW5nIGlzIHN1Y2Nlc3NmdWxsLAogICAgICogcmV0dXJucyBhIHZhbHVlIGV4cGxpY2l0bHkgb3IgaW1wbGljaXRseSBzcGVjaWZpZWQgYnkgdGhlIGdyYW1tYXIgZnJvbQogICAgICogd2hpY2ggdGhlIHBhcnNlciB3YXMgZ2VuZXJhdGVkIChzZWUgfFBFRy5idWlsZFBhcnNlcnwpLiBJZiB0aGUgcGFyc2luZyBpcwogICAgICogdW5zdWNjZXNzZnVsLCB0aHJvd3MgfFBFRy5wYXJzZXIuU3ludGF4RXJyb3J8IGRlc2NyaWJpbmcgdGhlIGVycm9yLgogICAgICovCiAgICBwYXJzZTogZnVuY3Rpb24oaW5wdXQsIHN0YXJ0UnVsZSkgewogICAgICB2YXIgcGFyc2VGdW5jdGlvbnMgPSB7CiAgICAgICAgImVxdWFsIjogcGFyc2VfZXF1YWwsCiAgICAgICAgImFkZGl0aXZlIjogcGFyc2VfYWRkaXRpdmUsCiAgICAgICAgInN1YnRyYWN0aXZlIjogcGFyc2Vfc3VidHJhY3RpdmUsCiAgICAgICAgIm11bHRpcGxpY2F0aXZlIjogcGFyc2VfbXVsdGlwbGljYXRpdmUsCiAgICAgICAgImRpdmlzaXZlIjogcGFyc2VfZGl2aXNpdmUsCiAgICAgICAgInByaW1hcnkiOiBwYXJzZV9wcmltYXJ5LAogICAgICAgICJpbnRlZ2VyIjogcGFyc2VfaW50ZWdlcgogICAgICB9OwogICAgICAKICAgICAgaWYgKHN0YXJ0UnVsZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKHBhcnNlRnVuY3Rpb25zW3N0YXJ0UnVsZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHJ1bGUgbmFtZTogIiArIHF1b3RlKHN0YXJ0UnVsZSkgKyAiLiIpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBzdGFydFJ1bGUgPSAiZXF1YWwiOwogICAgICB9CiAgICAgIAogICAgICB2YXIgcG9zID0geyBvZmZzZXQ6IDAsIGxpbmU6IDEsIGNvbHVtbjogMSwgc2VlbkNSOiBmYWxzZSB9OwogICAgICB2YXIgcmVwb3J0RmFpbHVyZXMgPSAwOwogICAgICB2YXIgcmlnaHRtb3N0RmFpbHVyZXNQb3MgPSB7IG9mZnNldDogMCwgbGluZTogMSwgY29sdW1uOiAxLCBzZWVuQ1I6IGZhbHNlIH07CiAgICAgIHZhciByaWdodG1vc3RGYWlsdXJlc0V4cGVjdGVkID0gW107CiAgICAgIHZhciBjYWNoZSA9IHt9OwogICAgICAKICAgICAgZnVuY3Rpb24gcGFkTGVmdChpbnB1dCwgcGFkZGluZywgbGVuZ3RoKSB7CiAgICAgICAgdmFyIHJlc3VsdCA9IGlucHV0OwogICAgICAgIAogICAgICAgIHZhciBwYWRMZW5ndGggPSBsZW5ndGggLSBpbnB1dC5sZW5ndGg7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYWRMZW5ndGg7IGkrKykgewogICAgICAgICAgcmVzdWx0ID0gcGFkZGluZyArIHJlc3VsdDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQogICAgICAKICAgICAgZnVuY3Rpb24gZXNjYXBlKGNoKSB7CiAgICAgICAgdmFyIGNoYXJDb2RlID0gY2guY2hhckNvZGVBdCgwKTsKICAgICAgICB2YXIgZXNjYXBlQ2hhcjsKICAgICAgICB2YXIgbGVuZ3RoOwogICAgICAgIAogICAgICAgIGlmIChjaGFyQ29kZSA8PSAweEZGKSB7CiAgICAgICAgICBlc2NhcGVDaGFyID0gJ3gnOwogICAgICAgICAgbGVuZ3RoID0gMjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZXNjYXBlQ2hhciA9ICd1JzsKICAgICAgICAgIGxlbmd0aCA9IDQ7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiAnXFwnICsgZXNjYXBlQ2hhciArIHBhZExlZnQoY2hhckNvZGUudG9TdHJpbmcoMTYpLnRvVXBwZXJDYXNlKCksICcwJywgbGVuZ3RoKTsKICAgICAgfQogICAgICAKICAgICAgZnVuY3Rpb24gY2xvbmUob2JqZWN0KSB7CiAgICAgICAgdmFyIHJlc3VsdCA9IHt9OwogICAgICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHsKICAgICAgICAgIHJlc3VsdFtrZXldID0gb2JqZWN0W2tleV07CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0KICAgICAgCiAgICAgIGZ1bmN0aW9uIGFkdmFuY2UocG9zLCBuKSB7CiAgICAgICAgdmFyIGVuZE9mZnNldCA9IHBvcy5vZmZzZXQgKyBuOwogICAgICAgIAogICAgICAgIGZvciAodmFyIG9mZnNldCA9IHBvcy5vZmZzZXQ7IG9mZnNldCA8IGVuZE9mZnNldDsgb2Zmc2V0KyspIHsKICAgICAgICAgIHZhciBjaCA9IGlucHV0LmNoYXJBdChvZmZzZXQpOwogICAgICAgICAgaWYgKGNoID09PSAiXG4iKSB7CiAgICAgICAgICAgIGlmICghcG9zLnNlZW5DUikgeyBwb3MubGluZSsrOyB9CiAgICAgICAgICAgIHBvcy5jb2x1bW4gPSAxOwogICAgICAgICAgICBwb3Muc2VlbkNSID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgaWYgKGNoID09PSAiXHIiIHx8IGNoID09PSAiXHUyMDI4IiB8fCBjaCA9PT0gIlx1MjAyOSIpIHsKICAgICAgICAgICAgcG9zLmxpbmUrKzsKICAgICAgICAgICAgcG9zLmNvbHVtbiA9IDE7CiAgICAgICAgICAgIHBvcy5zZWVuQ1IgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcG9zLmNvbHVtbisrOwogICAgICAgICAgICBwb3Muc2VlbkNSID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHBvcy5vZmZzZXQgKz0gbjsKICAgICAgfQogICAgICAKICAgICAgZnVuY3Rpb24gbWF0Y2hGYWlsZWQoZmFpbHVyZSkgewogICAgICAgIGlmIChwb3Mub2Zmc2V0IDwgcmlnaHRtb3N0RmFpbHVyZXNQb3Mub2Zmc2V0KSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChwb3Mub2Zmc2V0ID4gcmlnaHRtb3N0RmFpbHVyZXNQb3Mub2Zmc2V0KSB7CiAgICAgICAgICByaWdodG1vc3RGYWlsdXJlc1BvcyA9IGNsb25lKHBvcyk7CiAgICAgICAgICByaWdodG1vc3RGYWlsdXJlc0V4cGVjdGVkID0gW107CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJpZ2h0bW9zdEZhaWx1cmVzRXhwZWN0ZWQucHVzaChmYWlsdXJlKTsKICAgICAgfQogICAgICAKICAgICAgZnVuY3Rpb24gcGFyc2VfZXF1YWwoKSB7CiAgICAgICAgdmFyIGNhY2hlS2V5ID0gImVxdWFsQCIgKyBwb3Mub2Zmc2V0OwogICAgICAgIHZhciBjYWNoZWRSZXN1bHQgPSBjYWNoZVtjYWNoZUtleV07CiAgICAgICAgaWYgKGNhY2hlZFJlc3VsdCkgewogICAgICAgICAgcG9zID0gY2xvbmUoY2FjaGVkUmVzdWx0Lm5leHRQb3MpOwogICAgICAgICAgcmV0dXJuIGNhY2hlZFJlc3VsdC5yZXN1bHQ7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHZhciByZXN1bHQwLCByZXN1bHQxLCByZXN1bHQyOwogICAgICAgIHZhciBwb3MwLCBwb3MxOwogICAgICAgIAogICAgICAgIHBvczAgPSBjbG9uZShwb3MpOwogICAgICAgIHBvczEgPSBjbG9uZShwb3MpOwogICAgICAgIHJlc3VsdDAgPSBwYXJzZV9hZGRpdGl2ZSgpOwogICAgICAgIGlmIChyZXN1bHQwICE9PSBudWxsKSB7CiAgICAgICAgICBpZiAoaW5wdXQuY2hhckNvZGVBdChwb3Mub2Zmc2V0KSA9PT0gNjEpIHsKICAgICAgICAgICAgcmVzdWx0MSA9ICI9IjsKICAgICAgICAgICAgYWR2YW5jZShwb3MsIDEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0MSA9IG51bGw7CiAgICAgICAgICAgIGlmIChyZXBvcnRGYWlsdXJlcyA9PT0gMCkgewogICAgICAgICAgICAgIG1hdGNoRmFpbGVkKCJcIj1cIiIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAocmVzdWx0MSAhPT0gbnVsbCkgewogICAgICAgICAgICByZXN1bHQyID0gcGFyc2VfZXF1YWwoKTsKICAgICAgICAgICAgaWYgKHJlc3VsdDIgIT09IG51bGwpIHsKICAgICAgICAgICAgICByZXN1bHQwID0gW3Jlc3VsdDAsIHJlc3VsdDEsIHJlc3VsdDJdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJlc3VsdDAgPSBudWxsOwogICAgICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgICAgcG9zID0gY2xvbmUocG9zMSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdDAgPSBudWxsOwogICAgICAgICAgcG9zID0gY2xvbmUocG9zMSk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXN1bHQwICE9PSBudWxsKSB7CiAgICAgICAgICByZXN1bHQwID0gKGZ1bmN0aW9uKG9mZnNldCwgbGluZSwgY29sdW1uLCBsZWZ0LCByaWdodCkge3JldHVybiBsZWZ0ID09IHJpZ2h0O30pKHBvczAub2Zmc2V0LCBwb3MwLmxpbmUsIHBvczAuY29sdW1uLCByZXN1bHQwWzBdLCByZXN1bHQwWzJdKTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlc3VsdDAgPT09IG51bGwpIHsKICAgICAgICAgIHBvcyA9IGNsb25lKHBvczApOwogICAgICAgIH0KICAgICAgICBpZiAocmVzdWx0MCA9PT0gbnVsbCkgewogICAgICAgICAgcmVzdWx0MCA9IHBhcnNlX2FkZGl0aXZlKCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNhY2hlW2NhY2hlS2V5XSA9IHsKICAgICAgICAgIG5leHRQb3M6IGNsb25lKHBvcyksCiAgICAgICAgICByZXN1bHQ6ICByZXN1bHQwCiAgICAgICAgfTsKICAgICAgICByZXR1cm4gcmVzdWx0MDsKICAgICAgfQogICAgICAKICAgICAgZnVuY3Rpb24gcGFyc2VfYWRkaXRpdmUoKSB7CiAgICAgICAgdmFyIGNhY2hlS2V5ID0gImFkZGl0aXZlQCIgKyBwb3Mub2Zmc2V0OwogICAgICAgIHZhciBjYWNoZWRSZXN1bHQgPSBjYWNoZVtjYWNoZUtleV07CiAgICAgICAgaWYgKGNhY2hlZFJlc3VsdCkgewogICAgICAgICAgcG9zID0gY2xvbmUoY2FjaGVkUmVzdWx0Lm5leHRQb3MpOwogICAgICAgICAgcmV0dXJuIGNhY2hlZFJlc3VsdC5yZXN1bHQ7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHZhciByZXN1bHQwLCByZXN1bHQxLCByZXN1bHQyOwogICAgICAgIHZhciBwb3MwLCBwb3MxOwogICAgICAgIAogICAgICAgIHBvczAgPSBjbG9uZShwb3MpOwogICAgICAgIHBvczEgPSBjbG9uZShwb3MpOwogICAgICAgIHJlc3VsdDAgPSBwYXJzZV9tdWx0aXBsaWNhdGl2ZSgpOwogICAgICAgIGlmIChyZXN1bHQwICE9PSBudWxsKSB7CiAgICAgICAgICBpZiAoaW5wdXQuY2hhckNvZGVBdChwb3Mub2Zmc2V0KSA9PT0gNDMpIHsKICAgICAgICAgICAgcmVzdWx0MSA9ICIrIjsKICAgICAgICAgICAgYWR2YW5jZShwb3MsIDEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0MSA9IG51bGw7CiAgICAgICAgICAgIGlmIChyZXBvcnRGYWlsdXJlcyA9PT0gMCkgewogICAgICAgICAgICAgIG1hdGNoRmFpbGVkKCJcIitcIiIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAocmVzdWx0MSAhPT0gbnVsbCkgewogICAgICAgICAgICByZXN1bHQyID0gcGFyc2VfYWRkaXRpdmUoKTsKICAgICAgICAgICAgaWYgKHJlc3VsdDIgIT09IG51bGwpIHsKICAgICAgICAgICAgICByZXN1bHQwID0gW3Jlc3VsdDAsIHJlc3VsdDEsIHJlc3VsdDJdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJlc3VsdDAgPSBudWxsOwogICAgICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgICAgcG9zID0gY2xvbmUocG9zMSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdDAgPSBudWxsOwogICAgICAgICAgcG9zID0gY2xvbmUocG9zMSk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXN1bHQwICE9PSBudWxsKSB7CiAgICAgICAgICByZXN1bHQwID0gKGZ1bmN0aW9uKG9mZnNldCwgbGluZSwgY29sdW1uLCBsZWZ0LCByaWdodCkgeyByZXR1cm4gbGVmdCArIHJpZ2h0OyB9KShwb3MwLm9mZnNldCwgcG9zMC5saW5lLCBwb3MwLmNvbHVtbiwgcmVzdWx0MFswXSwgcmVzdWx0MFsyXSk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXN1bHQwID09PSBudWxsKSB7CiAgICAgICAgICBwb3MgPSBjbG9uZShwb3MwKTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlc3VsdDAgPT09IG51bGwpIHsKICAgICAgICAgIHJlc3VsdDAgPSBwYXJzZV9zdWJ0cmFjdGl2ZSgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjYWNoZVtjYWNoZUtleV0gPSB7CiAgICAgICAgICBuZXh0UG9zOiBjbG9uZShwb3MpLAogICAgICAgICAgcmVzdWx0OiAgcmVzdWx0MAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIHJlc3VsdDA7CiAgICAgIH0KICAgICAgCiAgICAgIGZ1bmN0aW9uIHBhcnNlX3N1YnRyYWN0aXZlKCkgewogICAgICAgIHZhciBjYWNoZUtleSA9ICJzdWJ0cmFjdGl2ZUAiICsgcG9zLm9mZnNldDsKICAgICAgICB2YXIgY2FjaGVkUmVzdWx0ID0gY2FjaGVbY2FjaGVLZXldOwogICAgICAgIGlmIChjYWNoZWRSZXN1bHQpIHsKICAgICAgICAgIHBvcyA9IGNsb25lKGNhY2hlZFJlc3VsdC5uZXh0UG9zKTsKICAgICAgICAgIHJldHVybiBjYWNoZWRSZXN1bHQucmVzdWx0OwogICAgICAgIH0KICAgICAgICAKICAgICAgICB2YXIgcmVzdWx0MCwgcmVzdWx0MSwgcmVzdWx0MjsKICAgICAgICB2YXIgcG9zMCwgcG9zMTsKICAgICAgICAKICAgICAgICBwb3MwID0gY2xvbmUocG9zKTsKICAgICAgICBwb3MxID0gY2xvbmUocG9zKTsKICAgICAgICByZXN1bHQwID0gcGFyc2VfbXVsdGlwbGljYXRpdmUoKTsKICAgICAgICBpZiAocmVzdWx0MCAhPT0gbnVsbCkgewogICAgICAgICAgaWYgKGlucHV0LmNoYXJDb2RlQXQocG9zLm9mZnNldCkgPT09IDQ1KSB7CiAgICAgICAgICAgIHJlc3VsdDEgPSAiLSI7CiAgICAgICAgICAgIGFkdmFuY2UocG9zLCAxKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlc3VsdDEgPSBudWxsOwogICAgICAgICAgICBpZiAocmVwb3J0RmFpbHVyZXMgPT09IDApIHsKICAgICAgICAgICAgICBtYXRjaEZhaWxlZCgiXCItXCIiKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKHJlc3VsdDEgIT09IG51bGwpIHsKICAgICAgICAgICAgcmVzdWx0MiA9IHBhcnNlX3N1YnRyYWN0aXZlKCk7CiAgICAgICAgICAgIGlmIChyZXN1bHQyICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgcmVzdWx0MCA9IFtyZXN1bHQwLCByZXN1bHQxLCByZXN1bHQyXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgICAgICBwb3MgPSBjbG9uZShwb3MxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0MCA9IG51bGw7CiAgICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgIH0KICAgICAgICBpZiAocmVzdWx0MCAhPT0gbnVsbCkgewogICAgICAgICAgcmVzdWx0MCA9IChmdW5jdGlvbihvZmZzZXQsIGxpbmUsIGNvbHVtbiwgbGVmdCwgcmlnaHQpIHsgcmV0dXJuIGxlZnQgLSByaWdodDsgfSkocG9zMC5vZmZzZXQsIHBvczAubGluZSwgcG9zMC5jb2x1bW4sIHJlc3VsdDBbMF0sIHJlc3VsdDBbMl0pOwogICAgICAgIH0KICAgICAgICBpZiAocmVzdWx0MCA9PT0gbnVsbCkgewogICAgICAgICAgcG9zID0gY2xvbmUocG9zMCk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXN1bHQwID09PSBudWxsKSB7CiAgICAgICAgICByZXN1bHQwID0gcGFyc2VfbXVsdGlwbGljYXRpdmUoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgY2FjaGVbY2FjaGVLZXldID0gewogICAgICAgICAgbmV4dFBvczogY2xvbmUocG9zKSwKICAgICAgICAgIHJlc3VsdDogIHJlc3VsdDAKICAgICAgICB9OwogICAgICAgIHJldHVybiByZXN1bHQwOwogICAgICB9CiAgICAgIAogICAgICBmdW5jdGlvbiBwYXJzZV9tdWx0aXBsaWNhdGl2ZSgpIHsKICAgICAgICB2YXIgY2FjaGVLZXkgPSAibXVsdGlwbGljYXRpdmVAIiArIHBvcy5vZmZzZXQ7CiAgICAgICAgdmFyIGNhY2hlZFJlc3VsdCA9IGNhY2hlW2NhY2hlS2V5XTsKICAgICAgICBpZiAoY2FjaGVkUmVzdWx0KSB7CiAgICAgICAgICBwb3MgPSBjbG9uZShjYWNoZWRSZXN1bHQubmV4dFBvcyk7CiAgICAgICAgICByZXR1cm4gY2FjaGVkUmVzdWx0LnJlc3VsdDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdmFyIHJlc3VsdDAsIHJlc3VsdDEsIHJlc3VsdDI7CiAgICAgICAgdmFyIHBvczAsIHBvczE7CiAgICAgICAgCiAgICAgICAgcG9zMCA9IGNsb25lKHBvcyk7CiAgICAgICAgcG9zMSA9IGNsb25lKHBvcyk7CiAgICAgICAgcmVzdWx0MCA9IHBhcnNlX3ByaW1hcnkoKTsKICAgICAgICBpZiAocmVzdWx0MCAhPT0gbnVsbCkgewogICAgICAgICAgaWYgKGlucHV0LmNoYXJDb2RlQXQocG9zLm9mZnNldCkgPT09IDQyKSB7CiAgICAgICAgICAgIHJlc3VsdDEgPSAiKiI7CiAgICAgICAgICAgIGFkdmFuY2UocG9zLCAxKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlc3VsdDEgPSBudWxsOwogICAgICAgICAgICBpZiAocmVwb3J0RmFpbHVyZXMgPT09IDApIHsKICAgICAgICAgICAgICBtYXRjaEZhaWxlZCgiXCIqXCIiKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKHJlc3VsdDEgIT09IG51bGwpIHsKICAgICAgICAgICAgcmVzdWx0MiA9IHBhcnNlX211bHRpcGxpY2F0aXZlKCk7CiAgICAgICAgICAgIGlmIChyZXN1bHQyICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgcmVzdWx0MCA9IFtyZXN1bHQwLCByZXN1bHQxLCByZXN1bHQyXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgICAgICBwb3MgPSBjbG9uZShwb3MxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0MCA9IG51bGw7CiAgICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgIH0KICAgICAgICBpZiAocmVzdWx0MCAhPT0gbnVsbCkgewogICAgICAgICAgcmVzdWx0MCA9IChmdW5jdGlvbihvZmZzZXQsIGxpbmUsIGNvbHVtbiwgbGVmdCwgcmlnaHQpIHsgcmV0dXJuIGxlZnQgKiByaWdodDsgfSkocG9zMC5vZmZzZXQsIHBvczAubGluZSwgcG9zMC5jb2x1bW4sIHJlc3VsdDBbMF0sIHJlc3VsdDBbMl0pOwogICAgICAgIH0KICAgICAgICBpZiAocmVzdWx0MCA9PT0gbnVsbCkgewogICAgICAgICAgcG9zID0gY2xvbmUocG9zMCk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXN1bHQwID09PSBudWxsKSB7CiAgICAgICAgICByZXN1bHQwID0gcGFyc2VfZGl2aXNpdmUoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgY2FjaGVbY2FjaGVLZXldID0gewogICAgICAgICAgbmV4dFBvczogY2xvbmUocG9zKSwKICAgICAgICAgIHJlc3VsdDogIHJlc3VsdDAKICAgICAgICB9OwogICAgICAgIHJldHVybiByZXN1bHQwOwogICAgICB9CiAgICAgIAogICAgICBmdW5jdGlvbiBwYXJzZV9kaXZpc2l2ZSgpIHsKICAgICAgICB2YXIgY2FjaGVLZXkgPSAiZGl2aXNpdmVAIiArIHBvcy5vZmZzZXQ7CiAgICAgICAgdmFyIGNhY2hlZFJlc3VsdCA9IGNhY2hlW2NhY2hlS2V5XTsKICAgICAgICBpZiAoY2FjaGVkUmVzdWx0KSB7CiAgICAgICAgICBwb3MgPSBjbG9uZShjYWNoZWRSZXN1bHQubmV4dFBvcyk7CiAgICAgICAgICByZXR1cm4gY2FjaGVkUmVzdWx0LnJlc3VsdDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdmFyIHJlc3VsdDAsIHJlc3VsdDEsIHJlc3VsdDI7CiAgICAgICAgdmFyIHBvczAsIHBvczE7CiAgICAgICAgCiAgICAgICAgcG9zMCA9IGNsb25lKHBvcyk7CiAgICAgICAgcG9zMSA9IGNsb25lKHBvcyk7CiAgICAgICAgcmVzdWx0MCA9IHBhcnNlX3ByaW1hcnkoKTsKICAgICAgICBpZiAocmVzdWx0MCAhPT0gbnVsbCkgewogICAgICAgICAgaWYgKGlucHV0LmNoYXJDb2RlQXQocG9zLm9mZnNldCkgPT09IDQ3KSB7CiAgICAgICAgICAgIHJlc3VsdDEgPSAiLyI7CiAgICAgICAgICAgIGFkdmFuY2UocG9zLCAxKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlc3VsdDEgPSBudWxsOwogICAgICAgICAgICBpZiAocmVwb3J0RmFpbHVyZXMgPT09IDApIHsKICAgICAgICAgICAgICBtYXRjaEZhaWxlZCgiXCIvXCIiKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKHJlc3VsdDEgIT09IG51bGwpIHsKICAgICAgICAgICAgcmVzdWx0MiA9IHBhcnNlX2RpdmlzaXZlKCk7CiAgICAgICAgICAgIGlmIChyZXN1bHQyICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgcmVzdWx0MCA9IFtyZXN1bHQwLCByZXN1bHQxLCByZXN1bHQyXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgICAgICBwb3MgPSBjbG9uZShwb3MxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0MCA9IG51bGw7CiAgICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgIH0KICAgICAgICBpZiAocmVzdWx0MCAhPT0gbnVsbCkgewogICAgICAgICAgcmVzdWx0MCA9IChmdW5jdGlvbihvZmZzZXQsIGxpbmUsIGNvbHVtbiwgbGVmdCwgcmlnaHQpIHsgcmV0dXJuIGxlZnQgLyByaWdodDsgfSkocG9zMC5vZmZzZXQsIHBvczAubGluZSwgcG9zMC5jb2x1bW4sIHJlc3VsdDBbMF0sIHJlc3VsdDBbMl0pOwogICAgICAgIH0KICAgICAgICBpZiAocmVzdWx0MCA9PT0gbnVsbCkgewogICAgICAgICAgcG9zID0gY2xvbmUocG9zMCk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXN1bHQwID09PSBudWxsKSB7CiAgICAgICAgICByZXN1bHQwID0gcGFyc2VfcHJpbWFyeSgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjYWNoZVtjYWNoZUtleV0gPSB7CiAgICAgICAgICBuZXh0UG9zOiBjbG9uZShwb3MpLAogICAgICAgICAgcmVzdWx0OiAgcmVzdWx0MAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIHJlc3VsdDA7CiAgICAgIH0KICAgICAgCiAgICAgIGZ1bmN0aW9uIHBhcnNlX3ByaW1hcnkoKSB7CiAgICAgICAgdmFyIGNhY2hlS2V5ID0gInByaW1hcnlAIiArIHBvcy5vZmZzZXQ7CiAgICAgICAgdmFyIGNhY2hlZFJlc3VsdCA9IGNhY2hlW2NhY2hlS2V5XTsKICAgICAgICBpZiAoY2FjaGVkUmVzdWx0KSB7CiAgICAgICAgICBwb3MgPSBjbG9uZShjYWNoZWRSZXN1bHQubmV4dFBvcyk7CiAgICAgICAgICByZXR1cm4gY2FjaGVkUmVzdWx0LnJlc3VsdDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdmFyIHJlc3VsdDAsIHJlc3VsdDEsIHJlc3VsdDI7CiAgICAgICAgdmFyIHBvczAsIHBvczE7CiAgICAgICAgCiAgICAgICAgcmVzdWx0MCA9IHBhcnNlX2ludGVnZXIoKTsKICAgICAgICBpZiAocmVzdWx0MCA9PT0gbnVsbCkgewogICAgICAgICAgcG9zMCA9IGNsb25lKHBvcyk7CiAgICAgICAgICBwb3MxID0gY2xvbmUocG9zKTsKICAgICAgICAgIGlmIChpbnB1dC5jaGFyQ29kZUF0KHBvcy5vZmZzZXQpID09PSA0MCkgewogICAgICAgICAgICByZXN1bHQwID0gIigiOwogICAgICAgICAgICBhZHZhbmNlKHBvcywgMSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgICAgaWYgKHJlcG9ydEZhaWx1cmVzID09PSAwKSB7CiAgICAgICAgICAgICAgbWF0Y2hGYWlsZWQoIlwiKFwiIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmIChyZXN1bHQwICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJlc3VsdDEgPSBwYXJzZV9hZGRpdGl2ZSgpOwogICAgICAgICAgICBpZiAocmVzdWx0MSAhPT0gbnVsbCkgewogICAgICAgICAgICAgIGlmIChpbnB1dC5jaGFyQ29kZUF0KHBvcy5vZmZzZXQpID09PSA0MSkgewogICAgICAgICAgICAgICAgcmVzdWx0MiA9ICIpIjsKICAgICAgICAgICAgICAgIGFkdmFuY2UocG9zLCAxKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVzdWx0MiA9IG51bGw7CiAgICAgICAgICAgICAgICBpZiAocmVwb3J0RmFpbHVyZXMgPT09IDApIHsKICAgICAgICAgICAgICAgICAgbWF0Y2hGYWlsZWQoIlwiKVwiIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChyZXN1bHQyICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICByZXN1bHQwID0gW3Jlc3VsdDAsIHJlc3VsdDEsIHJlc3VsdDJdOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICAgICAgICBwb3MgPSBjbG9uZShwb3MxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0MCA9IG51bGw7CiAgICAgICAgICAgIHBvcyA9IGNsb25lKHBvczEpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHJlc3VsdDAgIT09IG51bGwpIHsKICAgICAgICAgICAgcmVzdWx0MCA9IChmdW5jdGlvbihvZmZzZXQsIGxpbmUsIGNvbHVtbiwgYWRkaXRpdmUpIHsgcmV0dXJuIGFkZGl0aXZlOyB9KShwb3MwLm9mZnNldCwgcG9zMC5saW5lLCBwb3MwLmNvbHVtbiwgcmVzdWx0MFsxXSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAocmVzdWx0MCA9PT0gbnVsbCkgewogICAgICAgICAgICBwb3MgPSBjbG9uZShwb3MwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgY2FjaGVbY2FjaGVLZXldID0gewogICAgICAgICAgbmV4dFBvczogY2xvbmUocG9zKSwKICAgICAgICAgIHJlc3VsdDogIHJlc3VsdDAKICAgICAgICB9OwogICAgICAgIHJldHVybiByZXN1bHQwOwogICAgICB9CiAgICAgIAogICAgICBmdW5jdGlvbiBwYXJzZV9pbnRlZ2VyKCkgewogICAgICAgIHZhciBjYWNoZUtleSA9ICJpbnRlZ2VyQCIgKyBwb3Mub2Zmc2V0OwogICAgICAgIHZhciBjYWNoZWRSZXN1bHQgPSBjYWNoZVtjYWNoZUtleV07CiAgICAgICAgaWYgKGNhY2hlZFJlc3VsdCkgewogICAgICAgICAgcG9zID0gY2xvbmUoY2FjaGVkUmVzdWx0Lm5leHRQb3MpOwogICAgICAgICAgcmV0dXJuIGNhY2hlZFJlc3VsdC5yZXN1bHQ7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHZhciByZXN1bHQwLCByZXN1bHQxOwogICAgICAgIHZhciBwb3MwOwogICAgICAgIAogICAgICAgIHJlcG9ydEZhaWx1cmVzKys7CiAgICAgICAgcG9zMCA9IGNsb25lKHBvcyk7CiAgICAgICAgaWYgKC9eWzAtOV0vLnRlc3QoaW5wdXQuY2hhckF0KHBvcy5vZmZzZXQpKSkgewogICAgICAgICAgcmVzdWx0MSA9IGlucHV0LmNoYXJBdChwb3Mub2Zmc2V0KTsKICAgICAgICAgIGFkdmFuY2UocG9zLCAxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0MSA9IG51bGw7CiAgICAgICAgICBpZiAocmVwb3J0RmFpbHVyZXMgPT09IDApIHsKICAgICAgICAgICAgbWF0Y2hGYWlsZWQoIlswLTldIik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChyZXN1bHQxICE9PSBudWxsKSB7CiAgICAgICAgICByZXN1bHQwID0gW107CiAgICAgICAgICB3aGlsZSAocmVzdWx0MSAhPT0gbnVsbCkgewogICAgICAgICAgICByZXN1bHQwLnB1c2gocmVzdWx0MSk7CiAgICAgICAgICAgIGlmICgvXlswLTldLy50ZXN0KGlucHV0LmNoYXJBdChwb3Mub2Zmc2V0KSkpIHsKICAgICAgICAgICAgICByZXN1bHQxID0gaW5wdXQuY2hhckF0KHBvcy5vZmZzZXQpOwogICAgICAgICAgICAgIGFkdmFuY2UocG9zLCAxKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXN1bHQxID0gbnVsbDsKICAgICAgICAgICAgICBpZiAocmVwb3J0RmFpbHVyZXMgPT09IDApIHsKICAgICAgICAgICAgICAgIG1hdGNoRmFpbGVkKCJbMC05XSIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQwID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKHJlc3VsdDAgIT09IG51bGwpIHsKICAgICAgICAgIHJlc3VsdDAgPSAoZnVuY3Rpb24ob2Zmc2V0LCBsaW5lLCBjb2x1bW4sIGRpZ2l0cykgeyByZXR1cm4gcGFyc2VJbnQoZGlnaXRzLmpvaW4oIiIpLCAxMCk7IH0pKHBvczAub2Zmc2V0LCBwb3MwLmxpbmUsIHBvczAuY29sdW1uLCByZXN1bHQwKTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlc3VsdDAgPT09IG51bGwpIHsKICAgICAgICAgIHBvcyA9IGNsb25lKHBvczApOwogICAgICAgIH0KICAgICAgICByZXBvcnRGYWlsdXJlcy0tOwogICAgICAgIGlmIChyZXBvcnRGYWlsdXJlcyA9PT0gMCAmJiByZXN1bHQwID09PSBudWxsKSB7CiAgICAgICAgICBtYXRjaEZhaWxlZCgiaW50ZWdlciIpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjYWNoZVtjYWNoZUtleV0gPSB7CiAgICAgICAgICBuZXh0UG9zOiBjbG9uZShwb3MpLAogICAgICAgICAgcmVzdWx0OiAgcmVzdWx0MAogICAgICAgIH07CiAgICAgICAgcmV0dXJuIHJlc3VsdDA7CiAgICAgIH0KICAgICAgCiAgICAgIAogICAgICBmdW5jdGlvbiBjbGVhbnVwRXhwZWN0ZWQoZXhwZWN0ZWQpIHsKICAgICAgICBleHBlY3RlZC5zb3J0KCk7CiAgICAgICAgCiAgICAgICAgdmFyIGxhc3RFeHBlY3RlZCA9IG51bGw7CiAgICAgICAgdmFyIGNsZWFuRXhwZWN0ZWQgPSBbXTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV4cGVjdGVkLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAoZXhwZWN0ZWRbaV0gIT09IGxhc3RFeHBlY3RlZCkgewogICAgICAgICAgICBjbGVhbkV4cGVjdGVkLnB1c2goZXhwZWN0ZWRbaV0pOwogICAgICAgICAgICBsYXN0RXhwZWN0ZWQgPSBleHBlY3RlZFtpXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNsZWFuRXhwZWN0ZWQ7CiAgICAgIH0KICAgICAgCiAgICAgIAogICAgICAKICAgICAgdmFyIHJlc3VsdCA9IHBhcnNlRnVuY3Rpb25zW3N0YXJ0UnVsZV0oKTsKICAgICAgCiAgICAgIC8qCiAgICAgICAqIFRoZSBwYXJzZXIgaXMgbm93IGluIG9uZSBvZiB0aGUgZm9sbG93aW5nIHRocmVlIHN0YXRlczoKICAgICAgICoKICAgICAgICogMS4gVGhlIHBhcnNlciBzdWNjZXNzZnVsbHkgcGFyc2VkIHRoZSB3aG9sZSBpbnB1dC4KICAgICAgICoKICAgICAgICogICAgLSB8cmVzdWx0ICE9PSBudWxsfAogICAgICAgKiAgICAtIHxwb3Mub2Zmc2V0ID09PSBpbnB1dC5sZW5ndGh8CiAgICAgICAqICAgIC0gfHJpZ2h0bW9zdEZhaWx1cmVzRXhwZWN0ZWR8IG1heSBvciBtYXkgbm90IGNvbnRhaW4gc29tZXRoaW5nCiAgICAgICAqCiAgICAgICAqIDIuIFRoZSBwYXJzZXIgc3VjY2Vzc2Z1bGx5IHBhcnNlZCBvbmx5IGEgcGFydCBvZiB0aGUgaW5wdXQuCiAgICAgICAqCiAgICAgICAqICAgIC0gfHJlc3VsdCAhPT0gbnVsbHwKICAgICAgICogICAgLSB8cG9zLm9mZnNldCA8IGlucHV0Lmxlbmd0aHwKICAgICAgICogICAgLSB8cmlnaHRtb3N0RmFpbHVyZXNFeHBlY3RlZHwgbWF5IG9yIG1heSBub3QgY29udGFpbiBzb21ldGhpbmcKICAgICAgICoKICAgICAgICogMy4gVGhlIHBhcnNlciBkaWQgbm90IHN1Y2Nlc3NmdWxseSBwYXJzZSBhbnkgcGFydCBvZiB0aGUgaW5wdXQuCiAgICAgICAqCiAgICAgICAqICAgLSB8cmVzdWx0ID09PSBudWxsfAogICAgICAgKiAgIC0gfHBvcy5vZmZzZXQgPT09IDB8CiAgICAgICAqICAgLSB8cmlnaHRtb3N0RmFpbHVyZXNFeHBlY3RlZHwgY29udGFpbnMgYXQgbGVhc3Qgb25lIGZhaWx1cmUKICAgICAgICoKICAgICAgICogQWxsIGNvZGUgZm9sbG93aW5nIHRoaXMgY29tbWVudCAoaW5jbHVkaW5nIGNhbGxlZCBmdW5jdGlvbnMpIG11c3QKICAgICAgICogaGFuZGxlIHRoZXNlIHN0YXRlcy4KICAgICAgICovCiAgICAgIGlmIChyZXN1bHQgPT09IG51bGwgfHwgcG9zLm9mZnNldCAhPT0gaW5wdXQubGVuZ3RoKSB7CiAgICAgICAgdmFyIG9mZnNldCA9IE1hdGgubWF4KHBvcy5vZmZzZXQsIHJpZ2h0bW9zdEZhaWx1cmVzUG9zLm9mZnNldCk7CiAgICAgICAgdmFyIGZvdW5kID0gb2Zmc2V0IDwgaW5wdXQubGVuZ3RoID8gaW5wdXQuY2hhckF0KG9mZnNldCkgOiBudWxsOwogICAgICAgIHZhciBlcnJvclBvc2l0aW9uID0gcG9zLm9mZnNldCA+IHJpZ2h0bW9zdEZhaWx1cmVzUG9zLm9mZnNldCA/IHBvcyA6IHJpZ2h0bW9zdEZhaWx1cmVzUG9zOwogICAgICAgIAogICAgICAgIHRocm93IG5ldyB0aGlzLlN5bnRheEVycm9yKAogICAgICAgICAgY2xlYW51cEV4cGVjdGVkKHJpZ2h0bW9zdEZhaWx1cmVzRXhwZWN0ZWQpLAogICAgICAgICAgZm91bmQsCiAgICAgICAgICBvZmZzZXQsCiAgICAgICAgICBlcnJvclBvc2l0aW9uLmxpbmUsCiAgICAgICAgICBlcnJvclBvc2l0aW9uLmNvbHVtbgogICAgICAgICk7CiAgICAgIH0KICAgICAgCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9LAogICAgCiAgICAvKiBSZXR1cm5zIHRoZSBwYXJzZXIgc291cmNlIGNvZGUuICovCiAgICB0b1NvdXJjZTogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLl9zb3VyY2U7IH0KICB9OwogIAogIC8qIFRocm93biB3aGVuIGEgcGFyc2VyIGVuY291bnRlcnMgYSBzeW50YXggZXJyb3IuICovCiAgCiAgcmVzdWx0LlN5bnRheEVycm9yID0gZnVuY3Rpb24oZXhwZWN0ZWQsIGZvdW5kLCBvZmZzZXQsIGxpbmUsIGNvbHVtbikgewogICAgZnVuY3Rpb24gYnVpbGRNZXNzYWdlKGV4cGVjdGVkLCBmb3VuZCkgewogICAgICB2YXIgZXhwZWN0ZWRIdW1hbml6ZWQsIGZvdW5kSHVtYW5pemVkOwogICAgICAKICAgICAgc3dpdGNoIChleHBlY3RlZC5sZW5ndGgpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBleHBlY3RlZEh1bWFuaXplZCA9ICJlbmQgb2YgaW5wdXQiOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgZXhwZWN0ZWRIdW1hbml6ZWQgPSBleHBlY3RlZFswXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBleHBlY3RlZEh1bWFuaXplZCA9IGV4cGVjdGVkLnNsaWNlKDAsIGV4cGVjdGVkLmxlbmd0aCAtIDEpLmpvaW4oIiwgIikKICAgICAgICAgICAgKyAiIG9yICIKICAgICAgICAgICAgKyBleHBlY3RlZFtleHBlY3RlZC5sZW5ndGggLSAxXTsKICAgICAgfQogICAgICAKICAgICAgZm91bmRIdW1hbml6ZWQgPSBmb3VuZCA/IHF1b3RlKGZvdW5kKSA6ICJlbmQgb2YgaW5wdXQiOwogICAgICAKICAgICAgcmV0dXJuICJFeHBlY3RlZCAiICsgZXhwZWN0ZWRIdW1hbml6ZWQgKyAiIGJ1dCAiICsgZm91bmRIdW1hbml6ZWQgKyAiIGZvdW5kLiI7CiAgICB9CiAgICAKICAgIHRoaXMubmFtZSA9ICJTeW50YXhFcnJvciI7CiAgICB0aGlzLmV4cGVjdGVkID0gZXhwZWN0ZWQ7CiAgICB0aGlzLmZvdW5kID0gZm91bmQ7CiAgICB0aGlzLm1lc3NhZ2UgPSBidWlsZE1lc3NhZ2UoZXhwZWN0ZWQsIGZvdW5kKTsKICAgIHRoaXMub2Zmc2V0ID0gb2Zmc2V0OwogICAgdGhpcy5saW5lID0gbGluZTsKICAgIHRoaXMuY29sdW1uID0gY29sdW1uOwogIH07CiAgCiAgcmVzdWx0LlN5bnRheEVycm9yLnByb3RvdHlwZSA9IEVycm9yLnByb3RvdHlwZTsKICAKICByZXR1cm4gcmVzdWx0Owp9KSgpOwo=");
      document.getElementsByTagName("head")[0].appendChild(parserjs);
  }
  f();
  </script>

 <script src="client.js"></script>
<!--  <script src="game.js"></script>   -->
</head>
<body>
  <!-- <div id="qunit"></div> -->



<div id = "config">
           <select id="spacing">
            <option>1cm</option>
            <option>2cm</option>
            <option>1in</option>
            <option>1em</option>
            <option>70px</option>
          </select>
   </div>

<ul class="ruler horizontal" data-items="10"></ul>
<ul class="ruler vertical"data-items="5"></ul>

   <!-- <button id ="myButtonId" type=button onClick="output()"> + </button> -->



  <div class = "world" >
    <div id = "board"> </div>
   <div id= "user_area"> <button id ="validateBtn" type=button onClick="Game.validateBoard()"> Validate </button> 
    <div id = "rack"> </div>
      </div>
  </div>
   <div id="viewport"> </div>
</body>
</html>
